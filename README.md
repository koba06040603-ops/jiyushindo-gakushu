# 自由進度学習支援システム

## プロジェクト概要

**名前**: 自由進度学習支援システム  
**目標**: 子どもたちが自ら考え実行する力を育み、個別最適な学びを実現する  
**主要機能**: 
- 学年・教科・単元別の学習カード
- 3コース制（じっくり・しっかり・ぐんぐん）による個別最適化
- AI先生によるソクラテス対話
- リアルタイム進捗可視化
- 非認知能力の育成と評価
- 学習計画と振り返り機能
- **Phase 5**: 先生カスタマイズモード、指導・評価、学習環境デザイン、ゲーミフィケーション、ナラティブ機能

## 🌟 Phase 5 新機能（2024年実装完了）

### 先生カスタマイズモード
- 📝 学習環境デザイン：6観点の活動設定
- 📊 指導・評価タブ：3観点評価（ABC）+ 非認知能力7項目評価
- 🏆 ゲーミフィケーション：バッジシステム
- 📖 ナラティブ機能：学習ストーリー
- ⚙️ カスタマイズ設定：指導方針・目標・留意点

### 教育的価値
- **子どもの成長を多面的に評価**：認知・非認知の両面から評価
- **学びを物語として可視化**：達成感とモチベーション向上
- **先生の指導をサポート**：評価入力の効率化と指導のヒント提供
- **学習環境の最適化**：6観点で学びを深め、広げる活動設計

## URL

- **メインURL**: https://jiyushindo-gakushu.pages.dev
- **最新デプロイ**: https://1832454b.jiyushindo-gakushu.pages.dev
- **GitHub**: https://github.com/koba06040603-ops/jiyushindo-gakushu
- **最終コミット**: `6d08b28` (ユーザー認証・マルチユーザー対応)

## 🎉 実装完了した全機能

### ✅ フェーズ1：基本機能（完了）

1. **トップページ**
   - 学年選択（小学1年〜中学3年）
   - 教科選択（算数など）
   - 教科書会社選択（東京書籍など）
   - 単元選択
   - ユーザー情報表示

2. **学習のてびき**
   - 単元目標の表示
   - 非認知能力目標の表示
   - 授業時間の表示
   - 3コース選択問題（じっくり・しっかり・ぐんぐん）
   - チェックテスト説明
   - 選択問題6題の一覧表示
   - ツールバー（学習計画表・解答・進捗ボード）

3. **コース選択後の学習カード一覧**
   - 各コースの学習カード表示（6枚）
   - 難易度表示（基本・標準・発展）
   - 実社会との関連表示

### ✅ フェーズ2：学習機能（完了）

4. **学習カード詳細ページ**
   - 新出語句・キーワード表示
   - 例題と解き方の提示
   - 問題文と回答欄
   - 実社会との関連付け
   - 進捗バー表示

5. **ヒントカード機能**
   - 3段階のヒント表示
   - アコーディオン形式で開閉
   - 思考ツールの提案
   - 「9割型答えられる」設計

6. **AI先生（ソクラテス対話）**
   - Gemini API統合
   - チャット形式の対話
   - 答えを教えず考えを引き出す
   - 小学生向けの言葉選び
   - 励ましのメッセージ

7. **助けを求める機能**
   - 右上固定の助けボタン
   - 4つの選択肢：
     - 💡 ヒントカード
     - 🤖 AI先生に聞く
     - 👨‍🏫 先生を呼ぶ
     - 👥 友達に聞く
   - 助け要請回数の記録

8. **分かった度評価**
   - 5段階の絵文字選択
     - 😢 わからない
     - 😕 少し難しい
     - 😊 だいたいOK
     - 😄 よくわかる
     - 🤩 完璧！
   - 視覚的フィードバック

9. **学習進捗保存**
   - 理解度レベルの記録
   - 助け要請タイプの記録
   - 助けを求めた回数の記録
   - データベースへの自動保存

10. **解答表示機能**
    - 解答と解説のトグル表示
    - 詳細な解説付き

### ✅ フェーズ3：計画と管理機能（完了）

11. **学習計画表**
    - 単元全体の計画作成
    - 予定日・実施日の記録
    - 学習カード選択
    - オリエンテーションとまとめ（固定）
    - テーブル形式の一覧表示

12. **振り返り機能**
    - モーダルウィンドウでの記入
    - 3つの観点：
      - 😊 良かったこと
      - 😕 難しかったこと
      - 💡 わかったこと
    - 振り返り内容の保存と編集

13. **振り返りAI**
    - Gemini API統合
    - 個別フィードバック
    - 励ましと次へのヒント
    - 150文字以内の簡潔なメッセージ

14. **単元全体の振り返り**
    - 単元で学んだことの記録
    - 次に学びたいことの記録
    - メタ認知の促進

15. **解答タブ**
    - コース別解答表示
      - 🟢 じっくりコース
      - 🔵 しっかりコース
      - 🟣 ぐんぐんコース
    - 選択問題の解答例
    - 詳細な解説
    - 解答活用のヒント

### ✅ フェーズ4：教師支援機能（完了）

16. **進捗ボード（2026年1月全面改修✨）**
    - **タブレット最適化UI**：横スクロール対応、1200px最小幅
    - **一覧表示**：児童名、学習カード進捗、チェックテスト、選択問題を1画面で表示
    - **学習カード進捗**：3色棒グラフ（緑=じっくり、青=しっかり、紫=ぐんぐん）
    - **チェックテスト状況**：6問分の進捗を色分け表示（未実施/進行中/完了）
    - **選択問題状況**：6題分を丸で表示（未着手/進行中/完了）
    - **2教科同時対応**：複数カリキュラムを同時表示可能
    
17. **指導介入優先度スコアリング⭐NEW**
    - **自動スコア計算**：0-200点で指導優先度を数値化
    - **最優先（100点以上）**：ヘルプ要請中、待機時間を加算
    - **高優先（80-99点）**：理解度低（20点以下）かつ停滞中
    - **中優先（60-79点）**：30分以上停滞
    - **低優先（40-59点）**：理解度40点以下
    - **通常（20-39点）**：その他
    - **優先度順ソート**：自動的に支援が必要な児童を上位表示

18. **ヘルプ種別統計⭐NEW**
    - **4種類のアイコン表示**：
      - 🤖 AI先生（紫）
      - 👨‍🏫 先生（青）
      - 👥 友達（緑）
      - 💡 ヒント（黄）
    - **児童別集計**：各児童がどの支援を何回使ったか表示
    - **クラス全体統計**：支援方法別の使用回数を集計

19. **ヘルプ要請管理⭐NEW**
    - **リアルタイム表示**：ヘルプ要請中の児童一覧
    - **待機時間表示**：何分待っているか表示
    - **対象カード表示**：どの学習カードでヘルプを求めているか
    - **オレンジ背景強調**：ヘルプ要請中の児童を目立たせる

20. **停滞検知⭐NEW**
    - **自動検出**：最終活動から一定時間経過した児童を検出
    - **停滞時間表示**：何分停滞しているか表示
    - **対象カード表示**：どの学習カードで停滞しているか
    - **赤背景強調**：停滞中の児童を目立たせる

21. **大型テレビ対応⭐NEW**
    - **視認性重視**：遠くからでも見やすい大きなフォント
    - **色分け明確**：コース色、優先度色を明確に表示
    - **レスポンシブデザイン**：タブレット～大型テレビまで対応
    - **自動更新機能**：更新ボタンでリアルタイムデータ取得

22. **児童個別詳細モーダル⭐⭐NEW（2026年1月実装）**
    - **クリック表示**：児童名をクリックで詳細モーダル表示
    - **サマリーダッシュボード**：完了カード数、平均理解度、学習時間、ヘルプ回数
    - **3つのタブ**：
      - 📚 学習カード：各カードの状態、理解度、停滞/ヘルプ状態
      - 📝 テスト：チェックテスト（6問）と選択問題（6題）の進捗
      - 🆘 ヘルプ履歴：AI/先生/友達/ヒント別の統計と学習パターン分析
    - **視覚的フィードバック**：コース色、状態バッジ、絵文字理解度
    - **個人レポート出力**：個別PDF出力（予定）

23. **自動更新機能⭐⭐NEW（2026年1月実装）**
    - **トグルスイッチ**：ヘッダーで自動更新ON/OFF切替
    - **30秒間隔**：自動的に進捗データを更新
    - **リアルタイム監視**：ヘルプ要請や停滞状況を即座に把握
    - **バックグラウンド動作**：画面を開いたままで自動更新

24. **PDF出力機能⭐⭐NEW（2026年1月実装）**
    - **進捗ボードPDF**：現在の進捗状況を横向きA4でPDF出力
    - **週次レポートPDF**：週次統計をPDF化
    - **月次レポートPDF**：月次統計をPDF化
    - **個人レポートPDF**：児童個別レポート（予定）
    - **印刷最適化**：高品質（98%）JPEG、2倍スケール

25. **週次レポート⭐⭐NEW（2026年1月実装）**
    - **自動期間計算**：今週の月曜～日曜を自動設定
    - **児童別統計**：
      - 完了カード数
      - 平均理解度（色分け表示）
      - ヘルプ種別統計（AI/先生/友達/ヒント）
    - **表形式表示**：見やすいテーブルレイアウト
    - **PDF出力対応**：レポートをそのままPDF化

26. **月次レポート⭐⭐NEW（2026年1月実装）**
    - **当月自動設定**：現在の年月を自動設定
    - **児童別統計**：
      - 完了カード数
      - 平均理解度（色分け表示）
      - 活動日数
      - 総ヘルプ回数
    - **カリキュラム別進捗**：
      - 取組人数
      - 完了カード総数
    - **PDF出力対応**：月次レポートをPDF化

### ✅ フェーズ6：認証・セキュリティ機能（完了⭐⭐⭐NEW）

27. **ユーザー認証システム⭐⭐⭐NEW（2026年1月実装）**
    - **ログイン/ログアウト機能**：
      - 美しいログイン画面（グラデーション背景）
      - メールアドレス＋パスワード認証
      - セッション管理（24時間有効）
      - リフレッシュトークン（7日間有効）
    - **新規ユーザー登録**：
      - 氏名、メールアドレス、パスワード入力
      - 役割選択（児童・教師・管理者）
      - クラスコード設定
      - 出席番号（児童のみ）
    - **セキュリティ機能**：
      - パスワードのSHA-256ハッシュ化
      - セッショントークンの自動生成
      - ログイン失敗回数制限（5回で15分ロック）
      - アカウントロック機能

28. **ロールベース権限管理⭐⭐⭐NEW（2026年1月実装）**
    - **3つの役割（Role）**：
      - 👨‍🎓 **児童（student）**：学習カード閲覧、自分の進捗更新
      - 👨‍🏫 **教師（teacher）**：カリキュラム編集、進捗閲覧、レポート閲覧
      - 👑 **管理者（admin）**：すべての権限
    - **権限チェック**：
      - APIレベルでの権限検証
      - リソース別・アクション別の細かい制御
      - 権限テーブル（role_permissions）による管理
    - **認証ミドルウェア**：
      - `requireAuth`: ログイン必須
      - `requirePermission`: 権限必須

29. **監査ログ機能⭐⭐⭐NEW（2026年1月実装）**
    - **操作ログ記録**：誰が、いつ、何を、どうしたかを記録
    - **記録項目**：
      - ユーザーID
      - アクション（作成・更新・削除）
      - リソース（カリキュラム・学習カード・進捗）
      - リソースID
      - IPアドレス、User-Agent
      - 詳細情報（JSON）
    - **セキュリティ監視**：不正アクセスや誤操作の追跡

30. **デモアカウント**
    - **教師アカウント**：
      - メール: `demo@school.jp`
      - パスワード: `demo123`
      - クラス: CLASS2024A
    - **児童アカウント**：
      - メール: `student1@school.jp` (山田太郎)
      - メール: `student2@school.jp` (鈴木花子)
      - メール: `student3@school.jp` (佐藤次郎)
      - パスワード: `demo123`（共通）
      - クラス: CLASS2024A
    - **管理者アカウント**：
      - メール: `admin@school.jp`
      - パスワード: `demo123`

### ✅ フェーズ5：先生カスタマイズモード（完了）

22. **学習環境デザインタブ**
    - 6観点の環境デザイン設定：
      - 🎨 表現・クリエイティブ（作品制作、図の工夫）
      - 🔍 調査・フィールドワーク（身の回りの調査）
      - 🤔 多角的考察・クリティカルシンキング
      - 🌍 社会貢献・デザイン思考
      - 🧠 メタ認知・振り返り
      - ❓ 問いの生成
    - 各観点の有効/無効切替
    - 具体的な活動内容の記入
    - 学習のてびきへの反映

23. **指導・評価タブ**
    - 学習指導要領3観点評価（ABC評価）：
      - 📚 知識・技能
      - 💭 思考・判断・表現
      - ✨ 主体的に学習に取り組む態度
    - 観点ごとの評価コメント
    - 総合所見の記入

24. **非認知能力評価**
    - 7つの評価項目（1-5段階）：
      - 🎯 自己調整能力
      - 🔥 意欲・粘り強さ
      - 🤝 協働性
      - 🧠 メタ認知
      - 🎨 創造性
      - 🌟 好奇心
      - 💪 自己肯定感
    - 絵文字による視覚的評価
    - 各項目の詳細コメント
    - レーダーチャート可視化（準備完了）

25. **ゲーミフィケーション機能**
    - 🏆 バッジシステム：
      - 完走バッジ（全カード完了）
      - 教え上手バッジ（友達サポート）
      - 粘り強さバッジ（困難克服）
    - バッジ獲得履歴の表示
    - 獲得日時の記録

26. **ナラティブ機能**
    - 📖 学習ストーリー：
      - チャプター別の物語
      - マイルストーン達成の記録
      - 子どもの成長を物語として可視化
    - ストーリーテーマのカスタマイズ
    - 冒険・成長の記録

27. **先生カスタマイズ設定**
    - 👨‍🏫 先生の指導方針の記入
    - 📝 カスタム単元目標の設定
    - 🎯 カスタム非認知目標の設定
    - 💡 指導上の留意点の記録
    - ゲーミフィケーション設定の切替
    - ナラティブ機能の切替

28. **生徒別評価管理**
    - 児童選択ドロップダウン
    - 3観点評価の入力と保存
    - 非認知能力評価の入力と保存
    - バッジ獲得状況の確認
    - 学習ストーリーの閲覧

## データアーキテクチャ

### データモデル

**主要テーブル:**
- `users`: 教師・児童情報
- `classes`: クラス情報
- `curriculum`: カリキュラム（学年・教科・単元）
- `courses`: コース情報（基礎・標準・発展）
- `learning_cards`: 学習カード
- `hint_cards`: ヒントカード
- `optional_problems`: 選択問題（発展学習）
- `student_progress`: 学習進捗
- `learning_plans`: 学習計画
- `evaluations`: 評価データ（旧）
- `answers`: 解答と解説
- `learning_environment`: 学習環境デザイン（旧）
- `custom_content`: カスタマイズコンテンツ

**Phase 5 追加テーブル:**
- `three_point_evaluations`: 学習指導要領3観点評価
- `non_cognitive_evaluations`: 非認知能力7項目評価
- `learning_environment_designs`: 学習環境デザイン6観点
- `teacher_customization`: 先生のカスタマイズ設定
- `student_badges`: 獲得バッジ
- `learning_narratives`: 学習ストーリー

**Phase 6 追加テーブル（認証・セキュリティ）:**
- `user_sessions`: セッション管理（トークン、有効期限、IP、User-Agent）
- `role_permissions`: ロール別権限定義
- `audit_logs`: 監査ログ（操作履歴）

### ストレージサービス

- **Cloudflare D1**: SQLiteベースの分散データベース
- **ローカル開発**: `.wrangler/state/v3/d1`に自動生成

### データフロー

```
トップページ → 学習のてびき → コース選択 → 学習カード → 進捗保存
                     ↓              ↓              ↓
              学習計画表      進捗ボード      解答タブ
                     ↓              ↓
              振り返りAI      助け要請検知
```

## 主要な機能URI

### API エンドポイント

| エンドポイント | メソッド | 説明 | パラメータ |
|--------------|---------|------|-----------|
| `/api/curriculum/options` | GET | 学年・教科・教科書会社の選択肢取得 | なし |
| `/api/curriculum` | GET | カリキュラム一覧取得 | なし |
| `/api/curriculum/:id` | GET | 特定カリキュラムの詳細取得 | id: カリキュラムID |
| `/api/courses/:courseId/cards` | GET | コースの学習カード取得 | courseId: コースID |
| `/api/cards/:cardId` | GET | 学習カードの詳細とヒント取得 | cardId: カードID |
| `/api/progress` | POST | 学習進捗の保存 | student_id, curriculum_id, など |
| `/api/progress/class/:classCode` | GET | クラス全体の進捗取得 | classCode: クラスコード |
| `/api/progress/curriculum/:curriculumId/class/:classCode` | GET | カリキュラム別進捗取得 | curriculumId, classCode |
| `/api/plans/:studentId/:curriculumId` | GET | 学習計画取得 | studentId, curriculumId |
| `/api/plans` | POST | 学習計画保存 | student_id, curriculum_id, など |
| `/api/plans/:id` | PUT | 学習計画更新 | id: 計画ID |
| `/api/ai/ask` | POST | AI先生に質問 | cardId, question, context |
| `/api/ai/reflect` | POST | AI振り返りフィードバック | reflection_good, reflection_bad, など |
| `/api/answers/curriculum/:curriculumId` | GET | 全解答取得 | curriculumId: カリキュラムID |

**Phase 5 追加エンドポイント:**

| `/api/environment/design/:curriculumId` | GET | 学習環境デザイン取得 | curriculumId: カリキュラムID |
| `/api/environment/design` | POST | 学習環境デザイン保存 | curriculum_id, 6観点データ |
| `/api/environment/design/:id` | PUT | 学習環境デザイン更新 | id: デザインID |
| `/api/evaluations/three-point/student/:studentId/curriculum/:curriculumId` | GET | 3観点評価取得 | studentId, curriculumId |
| `/api/evaluations/three-point` | POST | 3観点評価保存 | student_id, curriculum_id, 評価データ |
| `/api/evaluations/three-point/:id` | PUT | 3観点評価更新 | id: 評価ID |
| `/api/evaluations/non-cognitive/student/:studentId/curriculum/:curriculumId` | GET | 非認知能力評価取得 | studentId, curriculumId |
| `/api/evaluations/non-cognitive` | POST | 非認知能力評価保存 | student_id, curriculum_id, 7項目データ |
| `/api/evaluations/non-cognitive/:id` | PUT | 非認知能力評価更新 | id: 評価ID |
| `/api/teacher/customization/:curriculumId` | GET | 先生カスタマイズ設定取得 | curriculumId: カリキュラムID |
| `/api/teacher/customization` | POST | 先生カスタマイズ設定保存 | curriculum_id, 設定データ |
| `/api/badges/student/:studentId/curriculum/:curriculumId` | GET | 生徒のバッジ取得 | studentId, curriculumId |
| `/api/narratives/student/:studentId/curriculum/:curriculumId` | GET | 学習ナラティブ取得 | studentId, curriculumId |

**Phase 6 追加エンドポイント（認証・セキュリティ）:**

| エンドポイント | メソッド | 説明 | パラメータ |
|--------------|---------|------|-----------|
| `/api/auth/register` | POST | 新規ユーザー登録 | name, email, password, role, class_code, student_number |
| `/api/auth/login` | POST | ログイン | email, password |
| `/api/auth/logout` | POST | ログアウト | Authorization: Bearer {token} |
| `/api/auth/refresh` | POST | セッション更新 | refresh_token |
| `/api/auth/me` | GET | 現在のユーザー情報取得 | Authorization: Bearer {token} |

### ページ一覧

| ページ | 説明 | アクセス |
|--------|------|---------|
| トップページ | 学年・教科・単元選択 | `/` |
| 学習のてびき | 単元全体の概要 | 単元選択後 |
| 学習カード | 問題・ヒント・AI先生 | コース選択後 |
| 学習計画表 | 計画・振り返り | 学習のてびきから |
| 解答タブ | 全解答と解説 | 学習のてびきから |
| 進捗ボード | クラス全体の進捗 | 学習のてびきから |
| **学習環境デザイン** | **6観点の環境設定** | **学習のてびき（教師用）** |
| **指導・評価** | **3観点・非認知評価** | **学習のてびき（教師用）** |

## 実装済み機能の詳細

### 児童向け機能

1. **自己調整学習**
   - 学習計画の作成
   - 自分のペースで進行
   - 振り返りの記録

2. **個別最適化**
   - 3コース制（じっくり・しっかり・ぐんぐん）
   - 自分に合ったコースを選択
   - 理解度に応じた学習

3. **多様な支援**
   - ヒントカード（3段階）
   - AI先生（ソクラテス対話）
   - 先生への助け要請
   - 友達との学び合い

4. **メタ認知の育成**
   - 分かった度の自己評価
   - 毎時間の振り返り
   - 単元全体の振り返り

### 教師向け機能

1. **進捗管理**
   - クラス全体の可視化
   - リアルタイム更新
   - コース別色分け

2. **早期介入**
   - 助け要請の検知
   - 停滞児童の発見
   - 指導優先度の提示

3. **データ分析**
   - 助けの種類別統計
   - 理解度の分布
   - 学習進捗の推移

4. **指導支援**
   - 指導のポイント提示
   - 個別指導の推奨
   - 発展課題の提案

5. **学習環境デザイン（Phase 5）**
   - 6観点の環境設定（表現・調査・考察・社会貢献・メタ認知・問い生成）
   - 各観点の有効/無効切替
   - 具体的な活動内容の記入
   - 学習カードへの反映

6. **指導・評価（Phase 5）**
   - 学習指導要領3観点評価（知識・技能、思考・判断・表現、態度）
   - ABC評価と詳細コメント
   - 非認知能力7項目評価（自己調整、意欲、協働性、メタ認知、創造性、好奇心、自己肯定感）
   - 1-5段階評価と詳細コメント
   - 総合所見の記録

7. **ゲーミフィケーション管理（Phase 5）**
   - 生徒のバッジ獲得状況の確認
   - バッジシステムの設定
   - 達成マイルストーンの管理

8. **ナラティブ機能（Phase 5）**
   - 生徒の学習ストーリーの閲覧
   - ストーリーテーマのカスタマイズ
   - 成長記録の可視化

9. **カスタマイズ設定（Phase 5）**
   - 指導方針の記録
   - カスタム単元目標の設定
   - カスタム非認知目標の設定
   - 指導上の留意点の記入

## サンプルデータ

**単元**: 小学3年算数「かけ算の筆算」  
**クラス**: さくら小学校 3年1組 (CLASS2024A)  
**児童数**: 5名（山田太郎、佐藤花子、鈴木次郎、田中三郎、伊藤美咲）  
**コース数**: 3コース（じっくり・しっかり・ぐんぐん）  
**学習カード数**: 18枚（各コース6枚）  
**選択問題数**: 6題  
**ヒント数**: 各カード3段階

### コース別学習カード

**じっくりコース（基礎）:**
1. 10のまとまりでかける
2. 何十のかけ算
3. 2けた×1けた（くり上がりなし）
4. 2けた×1けた（くり上がりあり）
5. 3けた×1けた（くり上がりなし）
6. 3けた×1けた（くり上がりあり）

**しっかりコース（標準）:**
1. かけ算の意味をふかめよう
2. 2けた×1けたの筆算（基本）
3. 2けた×1けた（くり上がり1回）
4. 3けた×1けた（くり上がりなし）
5. 3けた×1けた（くり上がり1回）
6. 3けた×1けた（くり上がり2回）

**ぐんぐんコース（発展）:**
1. かけ算のきまりを見つけよう
2. 2けた×1けた（応用問題）
3. 3けた×1けた（基礎から応用）
4. くり上がり2回の難問に挑戦
5. かけ算を使った問題づくり
6. かけ算のまちがい探し

### 選択問題（発展学習）

1. かけ算カレンダー作り（表現・クリエイティブ）
2. お店屋さんごっこ（調査・フィールドワーク）
3. かけ算の不思議を調べよう（多角的考察）
4. 学校のため算数プロジェクト（社会貢献）
5. かけ算日記をつけよう（メタ認知）
6. かけ算ゲーム大会（表現・クリエイティブ）

## 教育哲学

**基本概念**: 「子どもは自ら考え実行する力をもっている存在である」

### 育みたい力

1. **体験・感覚・具体操作**を大切にする
2. **感じる力**
3. **意欲**
4. **好き（興味・関心）**
5. **個別最適な個性**

### システムが目指すもの

- 子どもの自立
- AI時代における人間としての力
- 学びのハンドルを子ども自身が握る
- 教師の業務負担軽減
- 授業スタイルの転換
- 子ども観の変革

## 技術スタック

### バックエンド
- **フレームワーク**: Hono v4
- **言語**: TypeScript
- **実行環境**: Cloudflare Workers
- **データベース**: Cloudflare D1 (SQLite)
- **AI**: Gemini API (Google)

### フロントエンド
- **言語**: Vanilla JavaScript
- **スタイリング**: TailwindCSS (CDN)
- **アイコン**: Font Awesome (CDN)
- **HTTP Client**: Axios (CDN)

### 開発環境
- **ビルドツール**: Vite
- **プロセス管理**: PM2
- **バージョン管理**: Git

## デプロイメント

### 開発環境

- **プラットフォーム**: Cloudflare Pages (ローカル開発モード)
- **ステータス**: ✅ Active
- **URL**: https://3000-ifkm81ji5x491axns53a8-b9b802c4.sandbox.novita.ai

### ローカル開発コマンド

```bash
# データベースのリセット
npm run db:reset

# ローカル開発サーバー起動
npm run dev:sandbox

# ビルド
npm run build

# PM2で起動
pm2 start ecosystem.config.cjs

# PM2ログ確認
pm2 logs --nostream

# PM2停止
pm2 delete webapp
```

### 本番デプロイ（準備完了）

```bash
# 本番データベース作成
npx wrangler d1 create webapp-production

# マイグレーション適用
npm run db:migrate:prod

# デプロイ
npm run deploy:prod
```

## 環境変数設定

### Gemini APIキー

`.dev.vars` ファイルに設定：

```
GEMINI_API_KEY=your-gemini-api-key-here
```

**APIキーの取得:**
https://makersuite.google.com/app/apikey

## 今後の拡張可能な機能

### フェーズ5：カスタマイズ機能（未実装）

1. **先生カスタマイズモード**
   - 問題編集機能
   - カスタムコンテンツ作成
   - 学習カードの追加・削除

2. **指導・評価タブ**
   - 3観点評価（ABC）
   - 非認知能力評価
   - 指導上の留意点記録

3. **学習環境デザイン**
   - 6カテゴリの環境提案
   - アフォーダンス理論実装
   - 教室環境の具体化

### フェーズ6：多言語・アクセシビリティ（未実装）

4. **多言語対応**
   - 多言語選択機能
   - 自動翻訳機能

5. **音声支援**
   - Text-to-Speech機能
   - 問題文の読み上げ

6. **動的視覚支援**
   - アニメーション
   - インタラクティブ図表

## 開発の記録

### Git コミット履歴

```
feat: 進捗ボード実装 - クラス全体の可視化、助け要請検知、停滞検知、統計表示
feat: 学習計画表と解答タブ実装 - 計画作成、振り返り、AI振り返り、全解答表示
feat: 学習カード詳細ページ実装 - 問題表示、ヒント、ソクラテス対話、分かった度評価
feat: フェーズ1実装完了 - トップページ、学習のてびき、コース選択
Initial commit: Hono project setup
```

## 実装状況

### ✅ 完了済み機能

| フェーズ | 機能 | 完成度 | 備考 |
|---------|-----|-------|------|
| Phase 1 | 基本機能 | **100%** | トップページ、学習のてびき、コース選択 |
| Phase 2 | 学習機能 | **100%** | 学習カード、ヒント、AI先生、進捗保存 |
| Phase 3 | 計画・管理 | **100%** | 学習計画表、振り返り、解答タブ |
| Phase 4 | 教師支援 | **100%** | 進捗ボード、統計、レポート |
| Phase 5 | カスタマイズ | **100%** | 環境デザイン、評価、ゲーミフィケーション |
| **Phase 6** | **認証・セキュリティ⭐⭐⭐NEW** | **100%** | **ログイン、権限管理、監査ログ** |

**総合完成度: 99%** 🎉

### 📝 次のステップ候補

1. **履歴表示UI + ロールバック機能（2-3日）**
   - 編集履歴タブ実装
   - 変更差分表示（Before/After）
   - ワンクリックロールバック
   - 履歴検索・フィルタリング

2. **WebSocket実装（2-3日）**
   - リアルタイム進捗更新
   - ヘルプ要請の即座通知
   - 双方向通信

3. **個人レポート完全実装（1-2日）**
   - 児童個別詳細モーダルからPDF出力
   - 保護者向けレポート
   - 学習履歴の可視化

4. **多言語・アクセシビリティ（1週間以上）**
   - 多言語対応
   - Text-to-Speech機能
   - 動的視覚支援

## 最終更新日

2026-01-14

---

**開発者へ**: このシステムは、子どもたちの自律的な学びと先生方の働き方改革を両立させることを目指しています。一つひとつの機能が、子どもたちの成長と先生方の支援につながることを常に意識して開発を進めてください。

**Phase 6 ユーザー認証・マルチユーザー対応が完了しました！🎉✨**
