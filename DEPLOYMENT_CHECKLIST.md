# æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

æœ¬ç•ªç’°å¢ƒã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹å‰ã«ã€ä»¥ä¸‹ã®é …ç›®ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚

## âœ… å¿…é ˆãƒã‚§ãƒƒã‚¯é …ç›®

### 1. ç’°å¢ƒå¤‰æ•°ã®è¨­å®š

- [ ] **Gemini APIã‚­ãƒ¼è¨­å®šæ¸ˆã¿**
  - é–‹ç™ºç’°å¢ƒ: `.dev.vars`ãƒ•ã‚¡ã‚¤ãƒ«ã«è¨­å®š
  - æœ¬ç•ªç’°å¢ƒ: Cloudflare Pagesç’°å¢ƒå¤‰æ•°ã«è¨­å®š
  - ç¢ºèªæ–¹æ³•: `npx wrangler pages secret list --project-name jiyushindo-gakushu`

### 2. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æº–å‚™

- [ ] **æœ¬ç•ªãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ä½œæˆ**
  - `npx wrangler d1 create jiyushindo-gakushu-production`
  - `wrangler.jsonc`ã«database_idã‚’è¨˜è¼‰

- [ ] **ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®é©ç”¨**
  - `npx wrangler d1 migrations apply jiyushindo-gakushu-production --remote`
  - å…¨ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãŒæˆåŠŸã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª

- [ ] **ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ã®æŠ•å…¥ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰**
  - `npx wrangler d1 execute jiyushindo-gakushu-production --remote --file=./seed-auth.sql`

### 3. ã‚³ãƒ¼ãƒ‰ã®æº–å‚™

- [ ] **ãƒ“ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼ãŒãªã„**
  - `npm run build`ã§ã‚¨ãƒ©ãƒ¼ãŒãªã„ã“ã¨ã‚’ç¢ºèª

- [ ] **Gitã‚³ãƒŸãƒƒãƒˆæ¸ˆã¿**
  - ã™ã¹ã¦ã®å¤‰æ›´ãŒã‚³ãƒŸãƒƒãƒˆã•ã‚Œã¦ã„ã‚‹
  - `.env`, `.dev.vars`ãŒã‚³ãƒŸãƒƒãƒˆã•ã‚Œã¦ã„ãªã„ã“ã¨ã‚’ç¢ºèª

- [ ] **GitHubãƒ—ãƒƒã‚·ãƒ¥æ¸ˆã¿**
  - `git push origin main`ã§ãƒªãƒ¢ãƒ¼ãƒˆã«åæ˜ 

### 4. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç¢ºèª

- [ ] **æ©Ÿå¯†æƒ…å ±ã®ç¢ºèª**
  - `.gitignore`ã«`.env`, `.dev.vars`ãŒå«ã¾ã‚Œã¦ã„ã‚‹
  - Gitãƒªãƒã‚¸ãƒˆãƒªã«æ©Ÿå¯†æƒ…å ±ãŒã‚³ãƒŸãƒƒãƒˆã•ã‚Œã¦ã„ãªã„

- [ ] **èªè¨¼è¨­å®šã®ç¢ºèª**
  - ãƒ‡ãƒ¢ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å¤‰æ›´ï¼ˆæœ¬ç•ªé‹ç”¨æ™‚ï¼‰
  - ã‚»ãƒƒã‚·ãƒ§ãƒ³æœ‰åŠ¹æœŸé™ã®ç¢ºèª

## ğŸ“‹ ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †

### ã‚¹ãƒ†ãƒƒãƒ—1: æœ€çµ‚ç¢ºèª

```bash
cd /home/user/webapp

# ãƒ“ãƒ«ãƒ‰ãƒ†ã‚¹ãƒˆ
npm run build

# ãƒ­ãƒ¼ã‚«ãƒ«ãƒ†ã‚¹ãƒˆ
pm2 restart webapp
curl http://localhost:3000

# Gitã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç¢ºèª
git status
```

### ã‚¹ãƒ†ãƒƒãƒ—2: ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³é©ç”¨ï¼ˆåˆå›ã®ã¿ï¼‰

```bash
# æœ¬ç•ªãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³é©ç”¨
npx wrangler d1 migrations apply jiyushindo-gakushu-production --remote

# ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿æŠ•å…¥ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
npx wrangler d1 execute jiyushindo-gakushu-production --remote --file=./seed-auth.sql
```

### ã‚¹ãƒ†ãƒƒãƒ—3: ç’°å¢ƒå¤‰æ•°è¨­å®šï¼ˆåˆå›ã®ã¿ï¼‰

```bash
# Gemini APIã‚­ãƒ¼è¨­å®šï¼ˆå¯¾è©±çš„ã«å…¥åŠ›ï¼‰
npx wrangler pages secret put GEMINI_API_KEY --project-name jiyushindo-gakushu

# è¨­å®šç¢ºèª
npx wrangler pages secret list --project-name jiyushindo-gakushu
```

### ã‚¹ãƒ†ãƒƒãƒ—4: ãƒ‡ãƒ—ãƒ­ã‚¤å®Ÿè¡Œ

```bash
# ãƒ“ãƒ«ãƒ‰
npm run build

# ãƒ‡ãƒ—ãƒ­ã‚¤
npx wrangler pages deploy dist --project-name jiyushindo-gakushu

# ãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†å¾Œã€URLãŒè¡¨ç¤ºã•ã‚Œã‚‹
# ä¾‹: âœ¨ Deployment complete! Take a peek over at https://xxxx.jiyushindo-gakushu.pages.dev
```

### ã‚¹ãƒ†ãƒƒãƒ—5: å‹•ä½œç¢ºèª

ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã€ä»¥ä¸‹ã®æ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã—ã¦ãã ã•ã„ï¼š

1. **ãƒ­ã‚°ã‚¤ãƒ³æ©Ÿèƒ½**
   - ãƒ‡ãƒ¢ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ­ã‚°ã‚¤ãƒ³å¯èƒ½ã‹
   - ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒæ­£ã—ãä¿å­˜ã•ã‚Œã‚‹ã‹

2. **AIæ©Ÿèƒ½**
   - AIå…ˆç”ŸãŒæ­£å¸¸ã«å¿œç­”ã™ã‚‹ã‹
   - å¯¾è©±å±¥æ­´ãŒä¿å­˜ã•ã‚Œã‚‹ã‹
   - æŒ¯ã‚Šè¿”ã‚ŠAIãŒå‹•ä½œã™ã‚‹ã‹
   - å•é¡Œç”ŸæˆãŒå‹•ä½œã™ã‚‹ã‹

3. **é€²æ—ãƒœãƒ¼ãƒ‰**
   - ã‚¯ãƒ©ã‚¹å…¨ä½“ã®é€²æ—ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã‹
   - çµ±è¨ˆãŒæ­£ã—ãè¨ˆç®—ã•ã‚Œã‚‹ã‹
   - PDFå‡ºåŠ›ãŒå‹•ä½œã™ã‚‹ã‹

4. **å­¦ç¿’ã‚«ãƒ¼ãƒ‰**
   - å­¦ç¿’ã‚«ãƒ¼ãƒ‰ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã‹
   - ãƒ’ãƒ³ãƒˆãŒè¡¨ç¤ºã•ã‚Œã‚‹ã‹
   - é€²æ—ãŒä¿å­˜ã•ã‚Œã‚‹ã‹

## ğŸ” ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã®ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚¨ãƒ©ãƒ¼: "Gemini APIã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“"

**åŸå› **: ç’°å¢ƒå¤‰æ•°ãŒè¨­å®šã•ã‚Œã¦ã„ãªã„

**è§£æ±ºç­–**:
```bash
# ç’°å¢ƒå¤‰æ•°ã‚’ç¢ºèª
npx wrangler pages secret list --project-name jiyushindo-gakushu

# è¨­å®šã•ã‚Œã¦ã„ãªã„å ´åˆã¯è¿½åŠ 
npx wrangler pages secret put GEMINI_API_KEY --project-name jiyushindo-gakushu

# å†ãƒ‡ãƒ—ãƒ­ã‚¤
npm run build
npx wrangler pages deploy dist --project-name jiyushindo-gakushu
```

### ã‚¨ãƒ©ãƒ¼: "Database not found"

**åŸå› **: ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãŒé©ç”¨ã•ã‚Œã¦ã„ãªã„

**è§£æ±ºç­–**:
```bash
# ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çŠ¶æ…‹ã‚’ç¢ºèª
npx wrangler d1 migrations list jiyushindo-gakushu-production --remote

# ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³é©ç”¨
npx wrangler d1 migrations apply jiyushindo-gakushu-production --remote
```

### ã‚¨ãƒ©ãƒ¼: "Deployment failed"

**åŸå› **: ãƒ“ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼ã¾ãŸã¯è¨­å®šã‚¨ãƒ©ãƒ¼

**è§£æ±ºç­–**:
```bash
# ãƒ­ã‚°ã‚’ç¢ºèª
cat /home/user/.config/.wrangler/logs/wrangler-*.log

# ãƒ­ãƒ¼ã‚«ãƒ«ã§ãƒ“ãƒ«ãƒ‰ãƒ†ã‚¹ãƒˆ
npm run build

# wrangler.jsoncè¨­å®šã‚’ç¢ºèª
cat wrangler.jsonc
```

## ğŸ“Š ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°

ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã€ä»¥ä¸‹ã‚’å®šæœŸçš„ã«ç¢ºèªã—ã¦ãã ã•ã„ï¼š

1. **Cloudflare Analytics**
   - ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°ã€ã‚¨ãƒ©ãƒ¼ç‡ã‚’ç›£è¦–
   - ç•°å¸¸ãªãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ãŒãªã„ã‹ç¢ºèª

2. **Gemini APIä½¿ç”¨é‡**
   - Google AI Studioã§ãƒˆãƒ¼ã‚¯ãƒ³ä½¿ç”¨é‡ã‚’ç¢ºèª
   - ä½¿ç”¨åˆ¶é™ã«è¿‘ã¥ã„ã¦ã„ãªã„ã‹ç¢ºèª

3. **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚µã‚¤ã‚º**
   - D1ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ã‚µã‚¤ã‚ºã‚’ç›£è¦–
   - å®šæœŸçš„ãªã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã‚’æ¤œè¨

## ğŸ”„ æ›´æ–°ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †

ã‚³ãƒ¼ãƒ‰ã‚’æ›´æ–°ã—ã¦å†ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹å ´åˆï¼š

```bash
cd /home/user/webapp

# å¤‰æ›´ã‚’ã‚³ãƒŸãƒƒãƒˆ
git add -A
git commit -m "æ›´æ–°å†…å®¹ã®èª¬æ˜"
git push origin main

# ãƒ“ãƒ«ãƒ‰
npm run build

# ãƒ‡ãƒ—ãƒ­ã‚¤
npx wrangler pages deploy dist --project-name jiyushindo-gakushu
```

**æ³¨æ„**: ç’°å¢ƒå¤‰æ•°ã¯ä¸€åº¦è¨­å®šã™ã‚Œã°ã€å†ãƒ‡ãƒ—ãƒ­ã‚¤æ™‚ã«å†è¨­å®šã™ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

## ğŸ“ ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ‰‹é †

å•é¡ŒãŒç™ºç”Ÿã—ãŸå ´åˆã€ä»¥å‰ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã«ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã§ãã¾ã™ï¼š

1. Cloudflare Dashboardã«ãƒ­ã‚°ã‚¤ãƒ³
2. ã€ŒWorkers & Pagesã€â†’ã€Œjiyushindo-gakushuã€
3. ã€ŒDeploymentsã€ã‚¿ãƒ–ã‚’ã‚¯ãƒªãƒƒã‚¯
4. ä»¥å‰ã®ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã‚’é¸æŠ
5. ã€ŒRollback to this deploymentã€ã‚’ã‚¯ãƒªãƒƒã‚¯

ã¾ãŸã¯ã€Gitã‹ã‚‰ä»¥å‰ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å†ãƒ‡ãƒ—ãƒ­ã‚¤ï¼š

```bash
# ä»¥å‰ã®ã‚³ãƒŸãƒƒãƒˆã‚’ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆ
git checkout <commit-hash>

# ãƒ“ãƒ«ãƒ‰ï¼†ãƒ‡ãƒ—ãƒ­ã‚¤
npm run build
npx wrangler pages deploy dist --project-name jiyushindo-gakushu

# mainãƒ–ãƒ©ãƒ³ãƒã«æˆ»ã‚‹
git checkout main
```

## ğŸ‰ ãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†

ã™ã¹ã¦ã®ãƒã‚§ãƒƒã‚¯ãŒå®Œäº†ã—ã€ãƒ‡ãƒ—ãƒ­ã‚¤ãŒæˆåŠŸã—ãŸã‚‰ï¼š

1. æœ¬ç•ªURLã‚’ãƒãƒ¼ãƒ å…¨ä½“ã«å…±æœ‰
2. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã‚’é…å¸ƒ
3. ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’åé›†
4. ç¶™ç¶šçš„ãªæ”¹å–„ã‚’å®Ÿæ–½

---

**é‡è¦**: æœ¬ç•ªç’°å¢ƒã¯å¤šãã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒåˆ©ç”¨ã—ã¾ã™ã€‚å¿…ãšãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ååˆ†ã«ãƒ†ã‚¹ãƒˆã—ã¦ã‹ã‚‰ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¦ãã ã•ã„ã€‚
